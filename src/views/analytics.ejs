<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analytics</title>
  </head>
  <style>
    body {
      font-family: Arial, sans-serif;
      color: #333;
    }

    h1,
    h2 {
      text-align: center;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      background: #f5f5f5;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    p {
      margin: 5px 0;
      font-size: 0.9em;
    }

    .clicks {
      color: #20a387;
    }

    .views {
      color: #407cbc;
    }

    @media (min-width: 600px) {
      ul {
        max-width: 600px;
        margin: 0 auto;
      }

      li {
        display: flex;
        justify-content: space-between;
      }
    }
  </style>
  <body>
    <h2>Daily</h2>
    <ul>
      <% ads.forEach(ad => { %>
      <li>
        <%= ad.name %>
        <p>Clicks: <%= ad.clicked %></p>
        <p>Views: <%= ad.seen %></p>
      </li>
      <% }) %>
    </ul>

    <h2>Monthly</h2>
    <% const monthlyClicks = getMonthlyClicks(ads) %> <% const monthlyViews =
    getMonthlyViews(ads) %>

    <ul>
      <% monthlyClicks.forEach((clicks, i) => { %>
      <li>
        <%= getMonthFromIndex(i) %>
        <p>Clicks: <%= clicks %></p>
        <p>Views: <%= monthlyViews[i] %></p>
      </li>
      <% }) %>
    </ul>

    <h2>Yearly</h2>
    <% const yearlyClicks = getYearlyClicks(ads) %> <% const yearlyViews =
    getYearlyViews(ads) %>

    <ul>
      <% yearlyClicks.forEach((clicks, i) => { %>
      <li>
        <%= getYearFromIndex(i) %>
        <p>Clicks: <%= clicks %></p>
        <p>Views: <%= yearlyViews[i] %></p>
      </li>
      <% }) %>
    </ul>
    <script>
      function getMonthlyClicks(ads) {
        const monthlyClicks = [];

        ads.forEach((ad) => {
          const date = new Date(ad.createdAt);
          const month = date.getMonth();

          if (!monthlyClicks[month]) {
            monthlyClicks[month] = 0;
          }

          monthlyClicks[month] += ad.clicked;
        });

        return monthlyClicks;
      }

      function getMonthlyViews(ads) {
        const monthlyViews = [];

        ads.forEach((ad) => {
          const date = new Date(ad.createdAt);
          const month = date.getMonth();

          if (!monthlyViews[month]) {
            monthlyViews[month] = 0;
          }

          monthlyViews[month] += ad.seen;
        });

        return monthlyViews;
      }

      // Get month name from index
      function getMonthFromIndex(index) {
        const months = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];

        return months[index];
      }

      // Get total clicks for each year
      function getYearlyClicks(ads) {
        const yearlyClicks = [];

        ads.forEach((ad) => {
          const date = new Date(ad.createdAt);
          const year = date.getFullYear();

          if (!yearlyClicks[year]) {
            yearlyClicks[year] = 0;
          }

          yearlyClicks[year] += ad.clicked;
        });

        return yearlyClicks;
      }

      // Get total views for each year
      function getYearlyViews(ads) {
        const yearlyViews = [];

        ads.forEach((ad) => {
          const date = new Date(ad.createdAt);
          const year = date.getFullYear();

          if (!yearlyViews[year]) {
            yearlyViews[year] = 0;
          }

          yearlyViews[year] += ad.seen;
        });

        return yearlyViews;
      }

      // Get year from index
      function getYearFromIndex(index) {
        return 2020 + index;
      }
    </script>
  </body>
</html>
